# キーワード抽出ツール

商品タイトルやASINから類似商品をAmazonで検索する際のキーワードを抽出するツールです。

## ⚡ 最新アップデート (v2.4.0)

### 大規模スクレイピング堅牢化版
- **RateLimiter**: インテリジェントなレート制限管理（4-9秒待機、CAPTCHA時30秒ペナルティ）
- **自動リトライ**: 最大5回の自動リトライ、一時的なエラーを90%以上回復
- **User-Agentローテーション**: 12種類のリアルなUser-Agentから自動選択
- **バッチ処理**: 25件ごとに処理、バッチ間60秒クールダウンで安定性向上
- **進捗保存・再開**: 処理中断後も続きから再開可能（`.progress.json`）
- **メトリクス追跡**: リアルタイム統計表示（成功率、CAPTCHA回数など）
- **100件以上の処理が安定して実行可能**
- **実績**: 145件連続取得成功（失敗率0%）で動作確認済み

詳細は [CHANGELOG.md](CHANGELOG.md) を参照してください。

## 主要機能

- **処理モード選択**: 2つのモードから選択
  - **キーワード抽出**: 商品タイトルから検索用キーワードを抽出
  - **ブランド名取得**: ASINからブランド名のみを取得（高速処理）

- **ASIN対応**: ASINを入力して商品情報を自動取得
  - Amazon日本・アメリカの両サイトに対応
  - 商品タイトルとブランド名を自動取得

- **プロンプトテンプレート管理**: AI抽出の戦略をカスタマイズ
  - デフォルトテンプレート（「デフォルト」「シンプル」）搭載
  - カスタムプロンプトの追加・編集・削除が可能
  - プロンプトごとに異なる抽出ルールを設定

- **翻訳モード**: シンプルな2択から選択
  - **なし**: 翻訳を行わない（デフォルト）
  - **あり**: 自動言語判定で適切な翻訳を実行
    - 日本語キーワード → 英語に翻訳
    - 英語キーワード → 日本語に翻訳

- **3段階の抽出モード**:
  - **厳しめ**: ほぼ同じ商品を探すための詳細なキーワード（型番、サイズ、色など）
  - **標準**: バランスの取れたキーワード抽出
  - **緩め**: 大まかなカテゴリでのキーワード抽出

- **AI対応**: Gemini APIを使用した高精度なキーワード抽出

- **ユーザビリティ**:
  - **プログレスバー**: 処理状況の視覚的進捗表示
  - **ASIN列表示**: どのASINに対応したキーワードかが明確
  - セルクリックでコピー機能
  - 複数の一括コピーオプション（ASIN、ブランド、キーワードなど）
  - CSV出力機能
  - 直感的なGUIデザイン

## インストール

1. 必要なパッケージをインストール:
```bash
pip install -r requirements.txt
```

## 使い方

### 起動方法

**GUIのみ（推奨）:**
```bash
python keyword_extractor_cute.pyw
```
または `キーワード抽出ツール.bat` をダブルクリック

**デバッグ用（コンソール表示）:**
```bash
python keyword_extractor_cute.py
```

### 操作手順

1. **Amazon地域を選択**:
   - **日本Amazon**: amazon.co.jpからの商品情報取得
   - **アメリカAmazon**: amazon.comからの商品情報取得

2. **設定を選択**:
   - 翻訳モード（なし/あり）※ありの場合は自動言語判定
   - 抽出モード（厳しめ/標準/緩め）
   - ブランド名を含めるかのチェック
   - AI使用の有効/無効

3. **ASINを入力**:
   - ASINを1行に1つずつ入力

4. **「キーワード抽出」ボタンをクリック**

5. **結果の確認**:
   - 結果が表形式で表示されます
   - セルをクリックすると内容がコピーされます

6. **結果の活用**:
   - 個別セルクリックでコピー
   - 「一括コピー」で全結果をコピー
   - 「CSV出力」でファイル保存

## 注意事項

- インターネット接続が必要です（翻訳機能のため）
- Google Translate APIの制限により、大量の翻訳を短時間で行うと一時的に利用できなくなる場合があります